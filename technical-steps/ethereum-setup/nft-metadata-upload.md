---
description: >-
  Let's create the metadata ahead of time and upload it to Arweave so that we
  can launch the NFT with existing data.
---

# NFT Metadata Upload

Before we create the metadata for the NFTs, let's align on _what_ the collection is thematically:

* **Each NFT** represents a unique superpower.
* The **metadata** includes traits like speed, altitude, transparency, etc., that describe the superpower's characteristics.
* **Upgrading** is simply a matter of updating the metadata on Arweave and using the `upgradeSuperPower()` function to update the `TokenURI` on-chain.

With that in mind, let's proceed with the Irys SDK to upload images and set up the metadata prior to deploying the Contract. The beauty of Irys is that it abstracts away direct interaction with Arweave, so you can hone your focus on working with the data directly instead of the mechanics of the underlying storage network.



1. **Connecting to the Irys Network**

**Create a new folder called "scripts" and place the file "data\_uploader.ts" within it.**&#x20;

```typescript
import { Uploader } from "@irys/upload";
import { Ethereum } from "@irys/upload-ethereum";

const getIrys = async () => {
	const getIrysUploader = async () => {
		const irysUploader = await Uploader(Ethereum).withWallet(process.env.PRIVATE_KEY);
		console.log("obj",irysUploader)		
	  };
	  return getIrysUploader();
};
console.log("return",getIrys())
```

Run the connection program like so:&#x20;

```
yarn upload
```

You should see some output in the console showing various objects representing the connection to the Irys devnet

2. **Upload NFT Images via the Irys SDK**

Create a directory called "metadata" in the root directory.&#x20;

Move a number of desired images (or other type of unique data) that you would like to demonstrate the capabilities of upgradeable metadata. in our case, we used 2 1024x1024 images generated by ChatGPT. Those images have been placed in the "/metadata" directory.&#x20;

We're going to add significantly more capabilities to the uploader script now.&#x20;

{% hint style="info" %}
Note: to upload data greater than 100 KiB, you will need to fund your account with tokens. To view how to do this, [check out this page](https://docs.irys.xyz/build/d/sdk/payment/fund) or keep following along!
{% endhint %}

**data\_uploader.ts:**

```typescript
import { Uploader } from "@irys/upload";
import { Ethereum } from "@irys/upload-ethereum";
import Irys from "@irys/sdk"
import fs from 'fs';
import * as dotenv from 'dotenv';
dotenv.config(); 

const getIrys = async () => {
	const network = "devnet";
	// Devnet RPC URLs change often, use a recent one from https://chainlist.org/
	const providerUrl = process.env.RPC_URL || "https://rpc.devnet.irys.io";
	const token = "ethereum";
	const irys = new Irys({
		network, // "mainnet" or "devnet"
		token, // Token used for payment
		key: process.env.PRIVATE_KEY, // ETH or SOL private key
		config: { providerUrl }, // Optional provider URL, only required when using Devnet
	});
	return irys;
};

const fundFile = async (fileToUpload: string): Promise<boolean> => {
	try {
		const irys_devnet = await getIrys();
		const pathToFile = fileToUpload;
		const { size } = await fs.promises.stat(pathToFile);
		const price = await irys_devnet.getPrice(size); 
		const fund = await irys_devnet.fund(price);
		console.log("Funding 1 completed successfully.", fund);
		const fund2 = await irys_devnet.fund(price);
		console.log("Funding 2 completed successfully.", fund);
		await new Promise(resolve => setTimeout(resolve, 10000));
		return true;
	} catch (error) {
    console.error("Error funding file:", error);
    return false
	} 
};

const uploadFile = async () => {
	// const irys = await getIrysUploader();
	const irys_devnet = await getIrys();

	if (!irys_devnet) {
	  console.error("Error initializing Irys uploader or getIrys()");
	  return;
	}
	console.log("got irys line 58")
	// Your Image File!
	const fileToUpload = "./metadata/SuperPowerNFT-2.jpg";
	await fundFile(fileToUpload);
	const tags = [{ name: "application-id", value: "SuperPowerNFT" }];
 
	try {
		// console.log("trying")
		const receipt = await irys_devnet.uploadFile(fileToUpload, { tags: tags });
		console.log(`File uploaded ==> https://gateway.irys.xyz/${receipt.id}`);
		return;

	} catch (e) {
		console.log("Error uploading file ", e);
	}
};

uploadFile()
```

First, we have a function that connects to the irys devnet. This function uses the deprecated package from the @irys/sdk in order to perform the uploads and funding necessary to deploy the data to the irys devnet.

Next, we have a funding function that gets called right before the image is uploaded. The funding function calculates the size of the data being uploaded, and estimates the fees required to upload the data to the chain permanently. We call this function twice in order to be sure that we have enough leeway to fund the wallet before uploading larger components of data such as images.&#x20;

Finally, we have the upload functionality. This function uses the instantiation of the Irys network connection to grab the wallet key and pay for the upload of the image permanently to the Arweave network. Or in our case for devnet, for roughly 60 days as of this writing.



3. **Run the Upload Script**

```
yarn upload
```

This should now run the image uploader and fund the iIrys devnet Sepolia wallet in the process. You will see output like the following to confirm that the function works:

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

4. **Create the Metadata JSON**&#x20;

In your `metadata/` directory created in step 1 above, create a file named `initialMetadata.json`:

```json
{
  "name": "SuperPower: Flight",
  "description": "This NFT grants the superpower of flight. The superpower's attributes can evolve over time.",
  "attributes": [
    {
      "trait_type": "Superpower",
      "value": "Flight"
    },
    {
      "trait_type": "Speed",
      "value": "500 mph"
    },
    {
      "trait_type": "Max_Altitude",
      "value": "1,000 ft"
    },
    {
      "trait_type": "Heat Factor",
      "value": "Low"
    }
  ],
  "image": "https://gateway.irys.xyz/Cv6W0iQwzgniYxG-aA2BfZi5a3Cp6QKPFM2TnfLncUk"
}

```

For the image parameter, use the gateway Irys https url we received from the step above.



5. **Upload the text Metadata JSON File via Irys**

It is an exercise left to the reader to use the procedures that we previously used to deploy the above, in order to deploy the json file we have now.

